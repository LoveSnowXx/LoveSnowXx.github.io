---
title: 设计模式实例
date: 2019-07-02 17:54:36
tags: [设计模式]
cover_img:
feature_img:
description:
keywords:
---
### 实现按下键盘超级玛丽跑和跳
```
error code
window.onkeydown = function(e) {
    var code = e.which;
    if (code == 'run') {

    } else if (code == 'jump') {

    }
}

// correct code 
function mary() {
    this.statearr = [];
    this.action = {
        run: function() {

        },
        jump: function() {

        }
    }
}

mary.prototype.extends = function(name, fn) {
    this.action[name] = fn;
}

mary.prototype.addstate = function(state) {
    this.statearr.push(state);
    return this;
}

mary.prototype.exec = function(state) {
    var that = this;
    this.statearr.forEach(function(item, index) {
        that.action[item]();
    })
}

var maryob = new mary();
mary.extends('fire', function() {

})

window.onkeydown = function(event) {
    var code = event.which;
    mary.addState(code).exec();
}
```
### 三个异步操作，等三个执行完再执行操作
等待者模式实现
```
var arr = [
    function() {

    },
    function() {
        
    },
    function() {
        
    }
]
function awaiter(arr) {
    var len = arr.length;
    var nowfinish = 0;
    arr.forEach(function(fn, index) [
        setTimeout(function() {
            fn();
            nowfinish++;
            if (nowfinish == length) {
                console.log('all finish');
            }
        })
    ])
}
```



